% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cpgam.R
\name{cpgam}
\alias{cpgam}
\title{Fit a changepoint GAM model (internal)}
\usage{
cpgam(
  data,
  cp,
  regularize,
  model_type = c("case-only", "case-control"),
  bs = "tp",
  family = c("nb", "gaussian"),
  gam_method = "REML",
  gam_optimizer = "efs",
  fixed_effects = NULL,
  sp = NULL,
  k_mult = 1.2,
  n_try = 1,
  not_exp = F,
  silent = T
)
}
\arguments{
\item{data}{A data frame containing the time series data}

\item{cp}{Numeric changepoint time}

\item{regularize}{Logical; whether to use regularization for negative binomial models}

\item{model_type}{Character; either "case-only" or "case-control"}

\item{bs}{Character; basis type. Can be GAM bases ("tp", "null", "lin", "ilin", "dlin")
or SCAM bases ("micv", "mdcx", "cv", "cx", "micx", "mdcv")}

\item{family}{Character; either "nb" (negative binomial) or "gaussian"}

\item{gam_method}{Character; fitting method for GAM, defaults to "REML"}

\item{gam_optimizer}{Character; optimization method, defaults to "efs"}

\item{fixed_effects}{Character; additional fixed effects to include in model formula}

\item{sp}{Numeric; smoothing parameter(s)}

\item{k_mult}{Numeric; multiplier for basis dimension k}

\item{n_try}{Integer; number of fitting attempts}

\item{not_exp}{Logical; passed to scam::scam}

\item{silent}{Logical; whether to suppress warnings}
}
\value{
A fitted GAM or SCAM model object with additional components:
\itemize{
\item f: model formula
\item cp: changepoint time
\item bs: basis type used
\item data: input data
\item model_type: type of model fitted
\item se_ratio: ratio of maximum standard error to maximum counts
}
Returns NA if model fitting fails.
}
\description{
Internal function to fit a generalized additive model (GAM) with changepoint at a specified time.
Supports both case-only and case-control designs with negative binomial or gaussian families.
}
\keyword{internal}
